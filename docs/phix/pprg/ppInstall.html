<html><head><title>Print Preview and Report Generator Installation</title></head>
<style type="text/css">
<!--
body        {background-color: "#D0D0D0";}
a           {text-decoration: none;}
a:link      {color: "#0033BB"; text-decoration: underline;}
a:visited   {color: "#006699"; text-decoration: underline;}
a:active    {color: red; text-decoration: underline;}
a:hover     {color: red; text-decoration: underline;}
a.blue    {text-decoration: none;}
a.blue:link      {color: "#5500FF"; text-decoration: underline;}
a.blue:visited   {color: "#5500FF"; text-decoration: underline;}
a.blue:active    {color: red; text-decoration: underline;}
a.blue:hover     {color: red; text-decoration: underline;}
a.brown      {text-decoration: none;}
a.brown:link      {color: "#993333"; text-decoration: underline;}
a.brown:visited   {color: "#993333"; text-decoration: underline;}
a.brown:active    {color: red; text-decoration: underline;}
a.brown:hover     {color: red; text-decoration: underline;}
OL.n        { list-style-type: arabic-numbers }
OL.ua       { list-style-type: upper-alpha }
-->
</style>
<style>
BODY {SCROLLBAR-FACE-COLOR: #330066; SCROLLBAR-HIGHLIGHT-COLOR: #CCCCFF; 
      SCROLLBAR-SHADOW-COLOR: #CCCCFF; SCROLLBAR-3DLIGHT-COLOR: #CCCCFF; 
      SCROLLBAR-ARROW-COLOR:    #FFFFFF; SCROLLBAR-TRACK-COLOR: #CCCCFF; 
      SCROLLBAR-DARKSHADOW-COLOR: #330066; }
</style>
<body>
<a href="pprg.html">Table of Contents</a>
<a href="ppLicence.html">Previous Page - Licencing</a>
<a href="ppRef.html">Next Page - Reference Section</a>
<p><hr></p>
<p align=center>
<h2>Print Preview and Report Generator</h2>
<h3>Installation</h3></p>
<p><hr><p>
<p>
    The release should unzip to the following directory structure. Only the eleven files
    marked + need be distributed with an application incorporating print preview, plus
    win32lib.ew with printerDC global.
<p>
<p>
<pre>
        bitmaps\        -- buttons for titlebar, and graphics on reports
+         preview.bmp   -- icon for print preview
+         zpg.bmp       -- titlebar toolbar
+         zpr.bmp       -- ""
+         zps.bmp       -- ""
+         zpu.bmp       -- ""

+       pprg.ew         -- print preview and report generator (shrouded)
+       support.ew      -- support routines (unshrouded)
+       win32prt.ew     -- replacement print subroutines
        win32591.ew     -- compressed copy of win32lib, see notes below.
+       window.ew       -- Thomas Parslow's window finding functions
+       datadict.txt    -- example data dictionary
+       layout.edb      -- example layouts database

        pptest.exw      -- demo program (full source)
        pptest.exe      -- a standalone (bound) copy of the demo program

        simplest.exw    -- one page example of using print preview
        userfunc.ew     -- user defined functions (optional, used by pptest.exw)
        ffmt.e          -- financials formatting (optional, used by userfunc.ew)

        demo\           -- includes for pptest.exw; not needed for your application
          bitmaps\      -- bitmaps for the buttons in the demo program
            tutorial.bmp-- mortarboard & glasses
            dict.bmp    -- book with +-*/ on the cover
            load.bmp    -- forklift truck
            manual.bmp  -- books and manuals
            design.bmp  -- invoice with "+" resize cursor
            dump.bmp    -- JCB tipping
            bitmaps.bmp -- splatter of tiny squares
            calc.bmp    -- picture of a desktop calculator
            plain.bmp   -- A4 paper
            column.bmp  -- A4 paper showing 3 columns
            booklet.bmp -- picture of a booklet
            invoice.bmp -- invoice
            psml.bmp    -- icon for pptest.exw
            palmon.bmp  -- a bitmap used on the demo invoice print
          include\
            pptwin.ew   -- demo program's window etc.
            reg.ew      -- windows registry routines (Davi Tassinari de Figueiredo)
                        -- (only used to find the editor associated with .exw files;
                        --  there is no updating of the windows registry by these programs)
            tutorial.ew -- the tutorial program, run via pptest.exw
<!--			userfunc.ew -- user functions Capital()
            ffmt.e      -- user function ffmt()-->
        doc\
          pprg.html     -- Table of Contents
          ppIntro.html  -- Introduction
          ppOver.html   -- Overview
          ppLicence.html-- Licencing
          ppInstall.html-- Installation
          ppRef.html    -- Reference Section
          ppRef2.html   -- Reference Section Part 2
          ppRef3.html   -- Reference Section Part 3
          ppRef4.html   -- Reference Section Part 4
          ppFAQ.html    -- Frequently Asked Questions
          ppError.html  -- Error messages
          ppconst.e     -- see Implementation notes below
          images\       -- various images used in the manual.
</pre>
<p>
<a name=win32591></a>
<h5>win32591.ew</h5>
A copy of win32lib.ew, version 0.59.1, with printerDC made global, is included for
convenience. Note however this file has been specially created for the print preview
demo and is not recommended for further development or distribution. It has been
manually edited and clear shrouded so that it can be distributed as a single file.
Note that many standard win32lib routines are missing.
It's sole purpose for exsiting is an attempt to get pptest.exw running "out of the box" 
so you can decide whether or not you like it.
After that, get win32lib version 0.59.1 or later, and insert the word global before
"atom printerDC" (if its still not there), replace the include statements in pptest.exw
and simplest.ew, and throw win32591.ew away as soon as possible!
<p>
<p>
    Obviously, application developers are expected to create their own datadict.txt.
    If the sample layouts.edb is deleted at the start of a project, a new file is 
    created and the datadict.txt automatically loaded, after several appropriate 
    warnings, the next time that generateReport(name,"",PP_DESIGNMODE) is called.
<p>
At the last count (excluding win32lib) the eleven needed files add just 179Kb to the
distribution size of an application incorporating print preview and report generator
(120Kb zipped), which is tiny by todays standards (less than one tenth of a floppy!).<br>
Of course there is the small matter of some 166Kb of documentation, and 520Kb
of screen shots, probably more by now.
<p>
<p>
<a name=Source></a><h3>Source Code</h3>
<p>
    The full source code is not available.
<p>
    However, a mechanism exists to permit the shrouded component to utilise unshrouded
    sources. This mechanism is used for example on win32lib.ew, win32prt.ew, database.e, 
    support.ew, window.ew, and to some extent tutorial.ew.
    While this approach is not automated (significant manual effort is required) the
    possiblity exists to release selected parts of the source. Naturally this will only
    happen after careful consideration and with some justification that doing so will be
    beneficial to both parties.
<p>
    Please contact the author with specific requirements. 
    I am certainly not about to release the source simply to satisfy your curiosity or
    let someone else profit from my efforts.
    Requests of this nature 
    should begin by explaining some additional functionality you believe is required.
<p>
<p>
<h3>Contents of layout.edb</h3>
<p>
    The contents of this file should be considered private. Future versions of the 
    software may (further) encrypt the contents. Any external modification to this 
    file triggers a layout corruption error at load time.
<p>
<p>
<a name=Implement></a><h3>Implementation Notes</h3>
<p>
    Built with win32lib version 0.59.1 (8th June 2003).<br>
    Requires printerDC to be made global.
    (Forgetting to do so causes the obvious error in releaseprinter() in win32prt.ew)<br>
    Incompatible versions of win32lib should be automatically detected and trapped by
    routineid() (in support.ew).
<p>
    The file ppconst.e contains some 250 copies of constants from win32lib, database.e,
    and a few other common include files. It is released unshrouded since it is stictly 
    a derivative work of those files, and also to permit 3rd party verification of any 
    assumptions made. The file as released is not actually needed (it is already 
    incorporated in the shrouded pprg.ew file).
<p>
    There is (almost) no 3rd party code within pprg.ew. It uses the same copy of win32lib,
    database.e, wildcard.e, misc.e etc loaded into memory by the calling application.
<p>
    The following globals are defined in pprg.ew:
<p>
<pre>
        ppwin                               -- the main print preview window
        initialise_pprg(..)                 -- required by support.ew (and userfunc.ew)
        onClose_pprg(integer routineid)     -- closedown routine
        setCommissionCode(sequence code)    -- previously agreed code
        x=getDDidx(sequence field)          -- get field position/record length
        loadDDict()                         -- load datadict.txt into layouts.edb
        DemoListWin(object x)               -- used in pptest.ew
        pagetable                           -- the main data table
        pageSequenceHook(integer routineid) -- manipulate pagetable
        constants: PP_DESIGNMODE, PP_NOPREVIEW, PP_QUIETMODE, PP_TUTORIAL
        generateReport(sequence layoutname, sequence datastream, object pFlags)
</pre>
<p>
Additionally, the calling application may define a global function <tt>pprgdir()</tt> to 
indicate precisely where pprg.ew is installed, in case it is not in the working 
directory. If a global function of that name exists, for a different purpose, it
will be incorrectly called by support.ew. Lastly, userfunc.ew 
includes ffmt.e, which defines a global function <tt>ffmt()</tt>.
Those files are optional, and if they are not included it does not matter if 
another global routine called <tt>ffmt()</tt> exists or not.
<p>
If there is any conflict with other third party globals, the recommendation is to
use namespaces on the include pprg.ew and support.ew statements, since there are 
no nested include file problems, and the above is a fairly (surprisingly) short list.
<p>
It is clearly not possible to adequately document the print preview and report generator
routines solely in terms of the above interfaces. The best possible way to gain an
overall feel for the routines is to study simplest.exw (only one page) and pptest.exw.
The following links may also be useful:
<ul>
<li><a href="ppOver.html#loadDDict">loadDDict</a>.
<li><a href="ppOver.html#getDDidx">getDDidx</a>.
<li><a href="ppRef4.html#PSHook">pageSequenceHook</a>.
<li><a href="ppOver.html#onClosepprg">onClosepprg</a>.
<li><a href="ppOver.html#generateReport">generateReport</a> and the four PP_ constants.
<li><a href="ppLicence.html#setCommissionCode">setCommissionCode</a>.
</ul>
<p>
    The shrouded file uses the copies of win32lib and database.e linked into the calling 
    application. Hence any use of such libraries is the responsibility of the application 
    in terms of credits and acknowledgements.
<p>
    Naturally a link to the print preview web page will be appreciated, as will a short
    email to let me know when software using the routines is released.
<p>
<p>
<a name=Binding></a><h3>Binding</h3>
<p>
    Applications incorporating the shrouded print preview and report generator can 
    themselves be shrouded and/or bound.
<p>
    The pptest.exe program provided demonstrates this. Note datadict.txt, layout.edb,
    bitmaps\, and demo\bitmaps\ are still required when running pptest.exe.
<p>
<p>
</body>
<p><p><hr></p>
<p align=center>
<a href="pprg.html">Table of Contents</a>
<a href="ppLicence.html">Previous Page - Licencing</a>
<a href="ppRef.html">Next Page - Reference Section</a>
</p>
<p><hr><p><p>
</html>