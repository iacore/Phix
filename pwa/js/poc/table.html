<!DOCTYPE html>
<html lang="en" >
 <head>
  <meta charset="UTF-8">
  <title>CodePen - observer</title>
<!--
  <link rel="stylesheet" href="./table.css">
-->
  <link rel="stylesheet" href="../../pGUI.css">
 </head>
 <body>
   <br>
   <br>
   <p class="details"></p>
<!--
   <button>Refresh</button>
-->
  <script src="../../p2js.js"></script>
  <script src="../../builtins/ptagset.js"></script>
  <script src="../../builtins/pmaths.js"></script>
  <script src="../../pGUI.js"></script>
<!--
  <script src="./table.js"></script>
-->
  <script>
/*
const columns = ["sequence",
                 ["sequence","Chq#",80,"ARIGHT"],
                 ["sequence","Date",120,"ACENTER"],
                 ["sequence","Amount",210,"ARIGHT"],
                 ["sequence","Status",70,"ACENTER"],
                 ["sequence","Bank",105,"ALEFT"]];
*/
const columns = ["sequence",
                 ["sequence","Chq#",50,"ARIGHT"],
                 ["sequence","Date",80,"ACENTER"],
                 ["sequence","Amount",100,"ARIGHT"]];

//const columns = ["Chq#","Date","Amount","Status","Bank"] // (fine too) [DEV untested]
//const columns = ["sequence","Chq#","Date","Amount"] // (fine too)

//const MAX = 50000; // ~0.75s to build, 0s to display
//const MAX = 5000-0; // ~0.2s to build
//const MAX = 500-0-0; // ~0.035s to build

/*
function buildDummyData() {
    // data is length 2: {raw/sortable,null/display columns}
    let data = repeat(0,MAX);
//oh fuck... (cow semantics...)
//  data = ["sequence",data,["sequence",0,data,data]];
//  data = ["sequence",data,["sequence",0,repeat(0,MAX),repeat(0,MAX)]];
    data = ["sequence",[...data],["sequence",0,[...data],[...data]]];
    for (let i=1; i<=MAX; i += 1) {
        let dt = ["sequence",2018+rand(2),rand(12),rand(28)],
            cheque = i,
            date = sprintf("%02d/%02d/%04d",reverse(dt)),
            amount = rand(999999)/100,
            status = (rand(5)==1?"R":""),
            bank = sprintf("%5d", rand(22)+10000);
        data[1][i] = ["sequence",cheque,dt,amount,status,bank];
//      // initially overwritten with date/amt_fmt() below,
//      // however not when ' ' is subsequently keyed:
//      if (i==3) { date += '(this needs verifying)'; }
        data[2][2][i] = date;
        data[2][3][i] = sprintf("%.2f",amount);
    }
    return data;
}
*/

//DEV temp:
//let counter = document.querySelector('.details');
//  button = document.querySelector('button');
//  button.onclick = refresh_observer;

//let start = new Date().valueOf();
//let data = buildDummyData();
//let end = new Date().valueOf();
//counter.innerHTML = sprintf('%d lines (%3.2fs)',[length(data[1]),(end-start)/1000]);
let data = ["sequence",
            ["sequence",["sequence",1,["sequence",2020,1,13],1500.89],
                        ["sequence",2,["sequence",2020,7,10],3646.86],
                        ["sequence",3,["sequence",2019,3,20],3807.94]],
            ["sequence",0,
                        ["sequence",`13/01/2020`,`10/07/2020`,`20/03/2019`],
                        ["sequence",`1500.89`,`3646.86`,`3807.94`]]];
IupOpen()
let table = IupTable(columns,data,3),
      dlg = IupDialog(table);
IupSetAttribute(dlg,"RASTERSIZE","280x134"); // (see note)
IupSetAttribute(dlg,"TITLE","IupTable demo");
IupCloseOnEscape(dlg);
//IupSetAttributeHandle(NULL,"PARENTDIALOG",dlg)
IupShow(dlg);
//if platform()!=WEB then
//  IupMainLoop()
//  IupClose()
//end if

  
//DEV temp:
//document.body.insertBefore(table, document.body.firstChild);
  </script>
 </body>
</html>
